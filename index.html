<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
    <script>

      $(document).ready(function(){
        let $body = $('body'); // assigning the body to a variable
        let $button = $('<button></button>');
        $button.text('Auto Update: Off');

        $body.html(''); // emptying the body

        let currentTweet = 0;
        function loadTweets(){
          let allTweets = streams.home.length - 1;
            while(currentTweet < allTweets){
              console.log(currentTweet);
              let $tweet = $('<div></div>');
              let tweet = streams.home[currentTweet];
              $tweet.text(`@${tweet.user}: ${tweet.message}`);
              $tweet.appendTo($body);
              currentTweet++;
            }
        }
        // function update() {
        //   let index = streams.home.length
        // }
        loadTweets(); // Initial call to generate tweets.
        let intervalID;
        $button.prependTo($body); // make sure button stays at the top of the page
        $button.click(function() { // button click handler // trigger auto refresh
          if ($(this).text() === 'Auto Update: Off') {
            $(this).text('Auto Update: On');
            if (!intervalID) {
              intervalID = window.setInterval(loadTweets, 1000);
            }
            console.log(`Auto Update Started with Interval ID: ${intervalID}`)
          } else {
            $(this).text('Auto Update: Off');
            window.clearInterval(intervalID);
            console.log(`Auto Update Stopped with Interval ID: ${intervalID}`)
          }
        })


      });

    </script>
  </body>
</html>
